# Tmux configuration
# Gruvbox themed, vim-style keybindings

# ==========================
# General Settings
# ==========================

# Change prefix from Ctrl+b to Ctrl+a
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Enable mouse support
set -g mouse on

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Fast escape time (for vim)
set -sg escape-time 0

# Increase history limit
set -g history-limit 50000

# Enable true color support
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# Focus events for vim autoread
set -g focus-events on

# Vi mode for copy
setw -g mode-keys vi

# ==========================
# Key Bindings
# ==========================

# Reload config
bind r source-file ~/.tmux.conf \; display-message "Config reloaded!"

# Split panes with | and -
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Vim-style pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Vim-style pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Toggle maximize pane
bind m resize-pane -Z

# Vi copy mode bindings
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "wl-copy"
bind -T copy-mode-vi r send-keys -X rectangle-toggle

# Tmux sessionizer (if script exists)
bind -n C-o run-shell "if [ -x ~/.local/bin/tmux-sessionizer ]; then ~/.local/bin/tmux-sessionizer; fi"

# ==========================
# Status Bar (Gruvbox)
# ==========================

# Status bar position
set -g status-position bottom

# Status bar colors (Gruvbox)
set -g status-style "bg=#3c3836,fg=#ebdbb2"

# Status bar refresh interval
set -g status-interval 1

# Status bar length
set -g status-left-length 50
set -g status-right-length 50

# Left side: session name
set -g status-left "#[fg=#282828,bg=#98971a,bold] #S #[fg=#98971a,bg=#3c3836]"

# Right side: date and time
set -g status-right "#[fg=#504945,bg=#3c3836]#[fg=#ebdbb2,bg=#504945] %Y-%m-%d #[fg=#ebdbb2]#[fg=#282828,bg=#ebdbb2,bold] %H:%M "

# Window status
set -g window-status-format "#[fg=#a89984,bg=#3c3836] #I:#W "
set -g window-status-current-format "#[fg=#3c3836,bg=#504945]#[fg=#ebdbb2,bg=#504945,bold] #I:#W #[fg=#504945,bg=#3c3836]"

# Pane borders (Gruvbox)
set -g pane-border-style "fg=#504945"
set -g pane-active-border-style "fg=#98971a"

# Message style
set -g message-style "bg=#458588,fg=#ebdbb2"

# ==========================
# Plugins (TPM)
# ==========================

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Plugin settings
set -g @continuum-restore 'on'
set -g @resurrect-capture-pane-contents 'on'

# Initialize TPM (keep this at the very bottom)
run '~/.tmux/plugins/tpm/tpm'
